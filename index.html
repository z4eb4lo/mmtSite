<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Стрельба по Метлину</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #000;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
  <!-- Canvas для отрисовки игры -->
  <canvas id="gameCanvas"></canvas>
  <!-- Звук выстрела (берём из интернета) -->
  <audio id="gunshot" src="https://www.soundjay.com/misc/sounds/gun-shot-01.mp3"></audio>

  <script>
    // Получаем ссылку на canvas и устанавливаем его размеры
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // Загружаем изображение фона (Doom‑стиль)
    const bgImg = new Image();
    bgImg.src = 'https://i.imgur.com/0r5Q2Qc.jpg'; // URL фона, можно заменить другим

    // Загружаем изображение цели (Метлина) из локального файла (файл metlin.png должен лежать в той же папке)
    const metlinImg = new Image();
    metlinImg.src = 'metlin.png';

    // Элемент звука выстрела
    const gunshotAudio = document.getElementById('gunshot');

    // Начальные параметры цели (изображения Метлина)
    let target = {
      x: canvas.width / 2 - 50,
      y: canvas.height / 2 - 50,
      width: 100,
      height: 100
    };

    // Позиция мыши для отрисовки перекрестья
    let mousePos = { x: canvas.width / 2, y: canvas.height / 2 };

    // Обновление позиции мыши при движении для рисования перекрестья
    canvas.addEventListener('mousemove', function(e) {
      const rect = canvas.getBoundingClientRect();
      mousePos.x = e.clientX - rect.left;
      mousePos.y = e.clientY - rect.top;
    });

    // Обработка клика: воспроизводится звук выстрела и проверяется попадание по цели
    canvas.addEventListener('click', function(e) {
      // Сброс и воспроизведение звука
      gunshotAudio.currentTime = 0;
      gunshotAudio.play();

      // Определяем координаты клика относительно canvas
      const rect = canvas.getBoundingClientRect();
      const clickX = e.clientX - rect.left;
      const clickY = e.clientY - rect.top;

      // Если клик попал в область цели, перемещаем её в случайное место
      if (clickX >= target.x && clickX <= target.x + target.width &&
          clickY >= target.y && clickY <= target.y + target.height) {
        target.x = Math.random() * (canvas.width - target.width);
        target.y = Math.random() * (canvas.height - target.height);
      }
    });

    // Функция для отрисовки перекрестья (навигация для прицеливания)
    function drawCrosshair() {
      ctx.beginPath();
      ctx.moveTo(mousePos.x - 15, mousePos.y);
      ctx.lineTo(mousePos.x + 15, mousePos.y);
      ctx.moveTo(mousePos.x, mousePos.y - 15);
      ctx.lineTo(mousePos.x, mousePos.y + 15);
      ctx.strokeStyle = "red";
      ctx.lineWidth = 2;
      ctx.stroke();
    }

    // Основная функция отрисовки: фон, цель и перекрестье
    function draw() {
      // Рисуем фон, растянутый на весь экран
      ctx.drawImage(bgImg, 0, 0, canvas.width, canvas.height);
      // Рисуем изображение цели (Метлина)
      ctx.drawImage(metlinImg, target.x, target.y, target.width, target.height);
      // Рисуем перекрестье
      drawCrosshair();
    }

    // Игровой цикл с перерисовкой экрана
    function gameLoop() {
      draw();
      requestAnimationFrame(gameLoop);
    }

    // Запуск игрового цикла после загрузки изображений
    function startGame() {
      if (bgImg.complete && metlinImg.complete) {
        gameLoop();
      } else {
        setTimeout(startGame, 100);
      }
    }
    startGame();

    // Обновление размеров canvas при изменении размеров окна
    window.addEventListener('resize', function() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    });
  </script>
</body>
</html>
